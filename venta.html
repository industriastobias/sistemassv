<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Compra - KLOHESV</title>
  <style>
    :root{--bg:#fafafa;--card:#fff;--text:#000;--accent:#2563eb;--radius:12px;--shadow:0 4px 12px rgba(0,0,0,.08)}
    [data-theme="dark"]{--bg:#121212;--card:#1e1e1e;--text:#fff;--accent:#3b82f6}
    body{margin:0;font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);padding:40px}
    h1{margin-bottom:20px}
    .catalog{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px}
    .product{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;text-align:center}
    .product img{width:100%;height:150px;object-fit:cover;border-radius:8px}
    .product h3{margin:10px 0 6px;font-size:1rem}
    .product p{margin:4px 0;font-size:.9rem}
    .product button{margin-top:10px;padding:8px 14px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer}
    .cart{position:fixed;bottom:20px;right:20px;background:var(--accent);color:#fff;padding:12px 20px;border-radius:30px;box-shadow:var(--shadow);cursor:pointer;font-weight:600}
  </style>
</head>
<body>

  <h1>CatÃ¡logo de Productos</h1>

  <div class="catalog" id="catalog"></div>

  <div class="cart" onclick="verCarrito()">ðŸ›’ Ver carrito (<span id="cartCount">0</span>)</div>

  <script>
    const productos = [
      {
        codigo: "K001",
        nombre: "Camiseta KLOHESV Negra",
        precio: 15.00,
        imagen: "https://via.placeholder.com/300x200?text=Camiseta+Negra"
      },
      {
        codigo: "K002",
        nombre: "Camiseta KLOHESV Blanca",
        precio: 15.00,
        imagen: "https://via.placeholder.com/300x200?text=Camiseta+Blanca"
      },
      {
        codigo: "K003",
        nombre: "Sudadera KLOHESV Gris",
        precio: 25.00,
        imagen: "https://via.placeholder.com/300x200?text=Sudadera+Gris"
      }
    ];

    let carrito = [];

    function renderCatalogo() {
      const catalogo = document.getElementById('catalog');
      catalogo.innerHTML = productos.map(p => `
        <div class="product">
          <img src="${p.imagen}" alt="${p.nombre}">
          <h3>${p.nombre}</h3>
          <p><strong>$${p.precio.toFixed(2)} USD</strong></p>
          <p>CÃ³digo: ${p.codigo}</p>
          <button onclick="agregarAlCarrito('${p.codigo}')">Agregar</button>
        </div>
      `).join('');
    }

    function agregarAlCarrito(codigo) {
      const producto = productos.find(p => p.codigo === codigo);
      const existente = carrito.find(c => c.codigo === codigo);
      if (existente) {
        existente.cantidad += 1;
      } else {
        carrito.push({ ...producto, cantidad: 1 });
      }
      actualizarContador();
    }

    function actualizarContador() {
      const total = carrito.reduce((sum, item) => sum + item.cantidad, 0);
      document.getElementById('cartCount').textContent = total;
    }

    function verCarrito() {
      if (carrito.length === 0) {
        alert("El carrito estÃ¡ vacÃ­o.");
        return;
      }

      const confirmado = confirm(`Â¿Finalizar compra?\n\n${carrito.map(c => `${c.nombre} x${c.cantidad}`).join('\n')}`);
      if (!confirmado) return;

      // Guardar en localStorage con imagen
      let soldInventory = JSON.parse(localStorage.getItem('soldInventory')) || [];
      carrito.forEach(c => {
        soldInventory.push({
          name: c.nombre,
          code: c.codigo,
          price: c.precio,
          quantity: c.cantidad,
          total: c.precio * c.cantidad,
          image: c.imagen
        });
      });
      localStorage.setItem('soldInventory', JSON.stringify(soldInventory));

      // Vaciar carrito y redirigir
      carrito = [];
      actualizarContador();
      location.href = 'total.html';
    }

    window.addEventListener('DOMContentLoaded', renderCatalogo);
  </script>
</body>
</html>
