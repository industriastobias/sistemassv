<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Ventas</title>
<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{border:1px solid #ddd;padding:8px;text-align:center}
th{background:#333;color:#fff}
button{padding:8px 12px;margin:5px;cursor:pointer}
#facturaModal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  justify-content:center;
  align-items:center
}
.modal{
  background:#fff;
  padding:20px;
  width:80%;
}
</style>
</head>
<body>

<h2>Ventas</h2>

<table>
<thead>
<tr>
<th>âœ”</th>
<th>CÃ³digo</th>
<th>Producto</th>
<th>Cantidad</th>
<th>Total</th>
</tr>
</thead>
<tbody id="tablaVentas"></tbody>
</table>

<button onclick="abrirFactura()">ðŸ§¾ Generar Factura</button>

<div id="facturaModal">
  <div class="modal">
    <h3>Factura</h3>
    <label>Fecha:
      <input id="fFecha" readonly>
    </label>
    <table>
      <thead>
        <tr>
          <th>Producto</th>
          <th>Cantidad</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody id="tablaTicket"></tbody>
    </table>
    <button onclick="cerrarFactura()">Cerrar</button>
  </div>
</div>

<script>
// ðŸ”¹ PRODUCTOS DE EJEMPLO
const productos = [
  {code:'A01',name:'Producto A',quantity:1,total:50},
  {code:'B02',name:'Producto B',quantity:2,total:75.5},
  {code:'C03',name:'Producto C',quantity:1,total:30}
];

// ðŸ”¹ CARGAR TABLA
function cargarVentas(){
  const tb=document.getElementById('tablaVentas');
  tb.innerHTML='';
  productos.forEach(p=>{
    tb.innerHTML+=`
      <tr>
        <td><input type="checkbox" class="factCheck" value='${JSON.stringify(p)}'></td>
        <td>${p.code}</td>
        <td>${p.name}</td>
        <td>${p.quantity}</td>
        <td>$${p.total.toFixed(2)}</td>
      </tr>
    `;
  });
}
cargarVentas();

// ðŸ”¹ FACTURA
function abrirFactura(){
  const seleccionados=[...document.querySelectorAll('.factCheck:checked')];
  if(seleccionados.length===0){
    alert('Selecciona al menos un producto');
    return;
  }

  document.getElementById('facturaModal').style.display='flex';
  document.getElementById('fFecha').value=
    new Date().toLocaleDateString('es-SV');

  const tb=document.getElementById('tablaTicket');
  tb.innerHTML='';

  let ingresos=JSON.parse(localStorage.getItem('ingresos')||'[]');

  seleccionados.forEach(ch=>{
    const p=JSON.parse(ch.value);
    tb.innerHTML+=`
      <tr>
        <td>${p.name}</td>
        <td>${p.quantity}</td>
        <td>$${p.total.toFixed(2)}</td>
      </tr>
    `;

    ingresos.unshift({
      fecha:new Date().toISOString().slice(0,10),
      descripcion:`Venta: ${p.name}`,
      categoria:'Ventas',
      monto:Number(p.total),
      metodo_pago:'Efectivo',
      responsable:'Sistema',
      observaciones:`CÃ³digo ${p.code}`
    });
  });

  localStorage.setItem('ingresos',JSON.stringify(ingresos));
}

function cerrarFactura(){
  document.getElementById('facturaModal').style.display='none';
}
</script>
</body>
</html>
