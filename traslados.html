<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industrias Tobias | Proforma Comercial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --paper: #FDFCF8;
            --warm-gray: #F5F4F0;
            --mid-gray: #E5E4E0;
            --stone: #8C8B87;
            --charcoal: #2A2A28;
            --ink: #1A1A18;
            --tobias-blue: #4A5568;
            --tobias-gold: #B8860B;
            --success: #5A6B5C;
            --error: #8B4513;
            --border: 1px solid var(--mid-gray);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--paper);
            color: var(--charcoal);
            line-height: 1.6;
            font-size: 14px;
        }

        /* Header Tobias */
        header {
            background: var(--ink);
            padding: 2rem 3rem;
            border-bottom: 3px solid var(--tobias-gold);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .brand-tobias {
            display: flex;
            flex-direction: column;
        }

        .company-name {
            font-family: 'Crimson Text', serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--paper);
            letter-spacing: 1px;
        }

        .company-tagline {
            font-size: 0.75rem;
            color: var(--stone);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-top: 0.25rem;
            font-style: italic;
        }

        .header-badge {
            text-align: right;
            color: var(--stone);
            font-size: 0.85rem;
        }

        .doc-label {
            display: inline-block;
            background: var(--tobias-gold);
            color: var(--ink);
            padding: 0.5rem 1.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                padding: 2rem;
            }
        }

        /* Panels */
        .panel {
            background: white;
            border: var(--border);
            padding: 2.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .panel-title {
            font-family: 'Crimson Text', serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--tobias-gold);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .panel-icon {
            width: 28px;
            height: 28px;
            background: var(--warm-gray);
            border: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        /* Forms */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--stone);
        }

        input, select, textarea {
            padding: 0.875rem 1rem;
            border: var(--border);
            background: var(--paper);
            color: var(--charcoal);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
            transition: all 0.2s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--tobias-blue);
            background: white;
        }

        input::placeholder {
            color: var(--stone);
            opacity: 0.6;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238C8B87' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
        }

        /* Category Grid */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .category-card {
            border: var(--border);
            padding: 1.5rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            position: relative;
        }

        .category-card:hover, .category-card.active {
            border-color: var(--tobias-blue);
            background: var(--warm-gray);
        }

        .category-card.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--tobias-gold);
        }

        .category-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .category-name {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--charcoal);
        }

        /* Countries Section */
        .countries-section {
            background: var(--warm-gray);
            border: var(--border);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .countries-title {
            font-family: 'Crimson Text', serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--ink);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .countries-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .country-box {
            background: white;
            border: var(--border);
            padding: 1rem;
        }

        .country-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--stone);
            margin-bottom: 0.5rem;
        }

        .country-select {
            width: 100%;
            padding: 0.75rem;
            border: var(--border);
            background: white;
            font-size: 0.9rem;
        }

        /* Logistics Panel */
        .logistics-panel {
            background: var(--warm-gray);
            border: var(--border);
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .logistics-title {
            font-family: 'Crimson Text', serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--ink);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logistics-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .logistics-box {
            background: white;
            border: var(--border);
            padding: 1rem;
            text-align: center;
        }

        .logistics-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--stone);
            margin-bottom: 0.5rem;
        }

        .logistics-value {
            font-family: 'Crimson Text', serif;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--ink);
        }

        .logistics-input {
            width: 100%;
            text-align: center;
            padding: 0.5rem;
            font-size: 1rem;
            border: var(--border);
            background: white;
        }

        /* Product Lines */
        .product-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr auto;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--warm-gray);
            border-bottom: 2px solid var(--ink);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--stone);
        }

        .product-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr auto;
            gap: 0.75rem;
            align-items: center;
            padding: 0.75rem;
            border-bottom: var(--border);
            transition: background 0.2s;
        }

        .product-row:hover {
            background: var(--warm-gray);
        }

        .product-row input {
            padding: 0.625rem;
            font-size: 0.9rem;
            width: 100%;
        }

        .btn-remove {
            width: 32px;
            height: 32px;
            border: var(--border);
            background: transparent;
            color: var(--stone);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            transition: all 0.2s;
        }

        .btn-remove:hover {
            border-color: var(--error);
            color: var(--error);
            background: rgba(139, 69, 19, 0.05);
        }

        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border: none;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn-primary {
            background: var(--ink);
            color: var(--paper);
        }

        .btn-primary:hover {
            background: var(--tobias-blue);
        }

        .btn-secondary {
            background: transparent;
            color: var(--charcoal);
            border: var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--tobias-blue);
            color: var(--tobias-blue);
        }

        .btn-gold {
            background: var(--tobias-gold);
            color: var(--ink);
        }

        .btn-gold:hover {
            background: #DAA520;
        }

        .btn-add {
            width: 100%;
            margin-top: 1.5rem;
            justify-content: center;
            border: 1px dashed var(--stone);
            background: transparent;
            color: var(--stone);
        }

        .btn-add:hover {
            border-color: var(--tobias-blue);
            color: var(--tobias-blue);
            background: var(--warm-gray);
        }

        .actions {
            display: flex;
            gap: 1rem;
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: var(--border);
        }

        /* Preview Document */
        .preview-panel {
            position: sticky;
            top: 2rem;
            height: fit-content;
        }

        .document-frame {
            background: white;
            border: var(--border);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .document-header {
            background: var(--ink);
            color: var(--paper);
            padding: 2rem;
            text-align: center;
            border-bottom: 3px solid var(--tobias-gold);
        }

        .doc-company {
            font-family: 'Crimson Text', serif;
            font-size: 1.75rem;
            font-weight: 700;
            letter-spacing: 2px;
        }

        .doc-family {
            font-size: 0.8rem;
            color: var(--stone);
            font-style: italic;
            margin-top: 0.5rem;
            letter-spacing: 1px;
        }

        .doc-type {
            display: inline-block;
            background: var(--tobias-gold);
            color: var(--ink);
            padding: 0.5rem 2rem;
            font-size: 0.75rem;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-top: 1.5rem;
        }

        .document-body {
            padding: 2.5rem;
        }

        .trade-lane {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--warm-gray);
            border: var(--border);
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
        }

        .trade-box {
            text-align: center;
        }

        .trade-label {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--stone);
            margin-bottom: 0.25rem;
        }

        .trade-country {
            font-family: 'Crimson Text', serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--ink);
        }

        .trade-arrow {
            font-size: 1.5rem;
            color: var(--tobias-gold);
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .info-block {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .info-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--stone);
            border-bottom: 1px solid var(--mid-gray);
            padding-bottom: 0.25rem;
        }

        .info-value {
            font-weight: 500;
            color: var(--ink);
            font-size: 0.95rem;
        }

        .doc-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            font-size: 0.9rem;
        }

        .doc-table th {
            background: var(--warm-gray);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--ink);
            color: var(--ink);
        }

        .doc-table td {
            padding: 1rem;
            border-bottom: var(--border);
        }

        .doc-table .text-right {
            text-align: right;
        }

        .doc-table .text-center {
            text-align: center;
        }

        .totals-section {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--ink);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            font-size: 0.9rem;
        }

        .total-row.bold {
            font-weight: 600;
            font-size: 1rem;
        }

        .total-row.final {
            font-family: 'Crimson Text', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ink);
            border-top: 2px solid var(--tobias-gold);
            margin-top: 0.5rem;
            padding-top: 1rem;
        }

        .costs-breakdown {
            background: var(--warm-gray);
            border: var(--border);
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .costs-title {
            font-family: 'Crimson Text', serif;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--ink);
        }

        .costs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
        }

        .document-footer {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: var(--border);
            text-align: center;
            font-size: 0.8rem;
            color: var(--stone);
        }

        .document-stamp {
            position: absolute;
            bottom: 3rem;
            right: 3rem;
            width: 120px;
            height: 120px;
            border: 2px solid var(--tobias-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--tobias-gold);
            font-family: 'Crimson Text', serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            transform: rotate(-15deg);
            opacity: 0.25;
        }

        /* Loading */
        .loading {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(253, 252, 248, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 2px solid var(--mid-gray);
            border-top-color: var(--tobias-gold);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .category-grid { grid-template-columns: repeat(2, 1fr); }
            .logistics-grid { grid-template-columns: 1fr; }
            .countries-grid { grid-template-columns: 1fr; }
            .product-header, .product-row {
                grid-template-columns: 2fr 1fr 1fr auto;
            }
            .product-header > :nth-child(4),
            .product-header > :nth-child(5),
            .product-header > :nth-child(6),
            .product-row > :nth-child(4),
            .product-row > :nth-child(5),
            .product-row > :nth-child(6) {
                display: none;
            }
            .trade-lane {
                flex-direction: column;
                gap: 1rem;
            }
            .trade-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="brand-tobias">
                <span class="company-name">INDUSTRIAS TOBIAS</span>
                <span class="company-tagline">A Family Company</span>
            </div>
            <div class="header-badge">
                <div class="doc-label">Proforma</div>
                <div id="currentDate">12 FEB 2026</div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Formulario -->
        <div class="form-section">
            <!-- Pa√≠ses Origen/Destino -->
            <div class="panel">
                <h2 class="panel-title">
                    <span class="panel-icon">üåç</span>
                    Ruta Comercial
                </h2>
                
                <div class="countries-section">
                    <div class="countries-title">üìç Especificaci√≥n de Pa√≠ses</div>
                    <div class="countries-grid">
                        <div class="country-box">
                            <div class="country-label">Pa√≠s de Origen (Exportador)</div>
                            <select class="country-select" id="originCountry" onchange="updatePreview()">
                                <option value="US">Estados Unidos (USA)</option>
                                <option value="CN">China (China)</option>
                                <option value="PE">Per√∫ (Peru)</option>
                                <option value="CO">Colombia (Colombia)</option>
                                <option value="MX">M√©xico (Mexico)</option>
                                <option value="BR">Brasil (Brazil)</option>
                                <option value="AR">Argentina (Argentina)</option>
                                <option value="CL">Chile (Chile)</option>
                                <option value="IT">Italia (Italy)</option>
                                <option value="ES">Espa√±a (Spain)</option>
                                <option value="IN">India (India)</option>
                                <option value="BD">Bangladesh (Bangladesh)</option>
                                <option value="VN">Vietnam (Vietnam)</option>
                                <option value="ID">Indonesia (Indonesia)</option>
                                <option value="TR">Turqu√≠a (Turkey)</option>
                            </select>
                        </div>
                        <div class="country-box">
                            <div class="country-label">Pa√≠s de Destino (Importador)</div>
                            <select class="country-select" id="destinationCountry" onchange="updatePreview()">
                                <option value="PE">Per√∫ (Peru)</option>
                                <option value="US" selected>Estados Unidos (USA)</option>
                                <option value="MX">M√©xico (Mexico)</option>
                                <option value="CO">Colombia (Colombia)</option>
                                <option value="CL">Chile (Chile)</option>
                                <option value="AR">Argentina (Argentina)</option>
                                <option value="BR">Brasil (Brazil)</option>
                                <option value="EC">Ecuador (Ecuador)</option>
                                <option value="BO">Bolivia (Bolivia)</option>
                                <option value="PY">Paraguay (Paraguay)</option>
                                <option value="UY">Uruguay (Uruguay)</option>
                                <option value="PA">Panam√° (Panama)</option>
                                <option value="CR">Costa Rica (Costa Rica)</option>
                                <option value="GT">Guatemala (Guatemala)</option>
                                <option value="ES">Espa√±a (Spain)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Puerto/Aeropuerto de Origen</label>
                        <select id="originPort" onchange="updatePreview()">
                            <option value="JFK">JFK Airport, New York</option>
                            <option value="LAX">LAX Airport, Los Angeles</option>
                            <option value="MIA">Port of Miami, FL</option>
                            <option value="LGB">Long Beach Port, CA</option>
                            <option value="NY">Port of New York & New Jersey</option>
                            <option value="SAV">Port of Savannah, GA</option>
                            <option value="HOU">Port of Houston, TX</option>
                            <option value="CHI">Chicago O'Hare Airport</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Puerto/Aeropuerto de Destino</label>
                        <select id="destinationPort" onchange="updatePreview()">
                            <option value="CALLAO">Port of Callao, Lima</option>
                            <option value="LIMA">Jorge Ch√°vez Airport, Lima</option>
                            <option value="GUAYAQUIL">Port of Guayaquil, Ecuador</option>
                            <option value="VALPO">Port of Valpara√≠so, Chile</option>
                            <option value="BUENOS">Port of Buenos Aires, Argentina</option>
                            <option value="SANTOS">Port of Santos, Brazil</option>
                            <option value="BARRANQUILLA">Port of Barranquilla, Colombia</option>
                            <option value="CARTAGENA">Port of Cartagena, Colombia</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Datos del Cliente -->
            <div class="panel" style="margin-top: 2rem;">
                <h2 class="panel-title">
                    <span class="panel-icon">üë§</span>
                    Datos del Importador
                </h2>
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label>Raz√≥n Social / Company Name</label>
                        <input type="text" id="clientName" placeholder="Ej: Distribuidora Norteamericana S.A." oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label>Tax ID / EIN / RUC</label>
                        <input type="text" id="taxId" placeholder="12-3456789 / 20123456789" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label>Contacto / Buyer</label>
                        <input type="text" id="contactName" placeholder="Nombre del representante" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="email" placeholder="compras@empresa.com" oninput="updatePreview()">
                    </div>
                    <div class="form-group">
                        <label>Tel√©fono / WhatsApp</label>
                        <input type="tel" id="phone" placeholder="+1 (305) 555-0199" oninput="updatePreview()">
                    </div>
                    <div class="form-group full-width">
                        <label>Direcci√≥n de Entrega / Delivery Address</label>
                        <textarea id="address" rows="2" placeholder="Direcci√≥n completa de entrega final" oninput="updatePreview()"></textarea>
                    </div>
                </div>
            </div>

            <!-- Categor√≠a -->
            <div class="panel" style="margin-top: 2rem;">
                <h2 class="panel-title">
                    <span class="panel-icon">üè∑Ô∏è</span>
                    Categor√≠a de Producto
                </h2>
                <div class="category-grid">
                    <div class="category-card" onclick="selectCategory('textile')" data-cat="textile">
                        <span class="category-icon">üßµ</span>
                        <div class="category-name">Textil</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('footwear')" data-cat="footwear">
                        <span class="category-icon">üëû</span>
                        <div class="category-name">Calzado</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('accessories')" data-cat="accessories">
                        <span class="category-icon">üëú</span>
                        <div class="category-name">Accesorios</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('cosmetics')" data-cat="cosmetics">
                        <span class="category-icon">üíÑ</span>
                        <div class="category-name">Maquillaje</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('home')" data-cat="home">
                        <span class="category-icon">üè†</span>
                        <div class="category-name">Hogar</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('industrial')" data-cat="industrial">
                        <span class="category-icon">‚öôÔ∏è</span>
                        <div class="category-name">Industrial</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('raw')" data-cat="raw">
                        <span class="category-icon">üß∂</span>
                        <div class="category-name">Materia Prima</div>
                    </div>
                    <div class="category-card" onclick="selectCategory('other')" data-cat="other">
                        <span class="category-icon">üì¶</span>
                        <div class="category-name">Otros</div>
                    </div>
                </div>
            </div>

            <!-- Log√≠stica y Costos -->
            <div class="panel" style="margin-top: 2rem;">
                <h2 class="panel-title">
                    <span class="panel-icon">üö¢</span>
                    Costos de Importaci√≥n
                </h2>
                
                <div class="logistics-panel">
                    <div class="logistics-title">üì¶ Informaci√≥n de Carga</div>
                    <div class="logistics-grid">
                        <div class="logistics-box">
                            <div class="logistics-label">Peso Total (kg)</div>
                            <input type="number" class="logistics-input" id="totalWeight" placeholder="0.00" step="0.01" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">Volumen (CBM)</div>
                            <input type="number" class="logistics-input" id="totalVolume" placeholder="0.00" step="0.01" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">Tipo de Carga</div>
                            <select class="logistics-input" id="cargoType" onchange="updatePreview()">
                                <option value="FCL">FCL (Contenedor)</option>
                                <option value="LCL">LCL (Consolidado)</option>
                                <option value="AIR">A√©reo</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="logistics-panel" style="margin-top: 1rem;">
                    <div class="logistics-title">üí∞ Costos Internacionales</div>
                    <div class="logistics-grid">
                        <div class="logistics-box">
                            <div class="logistics-label">Flete / Freight ($)</div>
                            <input type="number" class="logistics-input" id="shippingCost" placeholder="0.00" step="0.01" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">Seguro / Insurance (%)</div>
                            <input type="number" class="logistics-input" id="insuranceRate" placeholder="2" value="2" step="0.1" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">Handling / THC ($)</div>
                            <input type="number" class="logistics-input" id="handlingCost" placeholder="0.00" step="0.01" oninput="updateCalculations()">
                        </div>
                    </div>
                </div>

                <div class="logistics-panel" style="margin-top: 1rem;">
                    <div class="logistics-title">üìã Impuestos y Aranceles</div>
                    <div class="logistics-grid">
                        <div class="logistics-box">
                            <div class="logistics-label">Derecho Aduanal (%)</div>
                            <input type="number" class="logistics-input" id="customsDuty" placeholder="0" step="0.1" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">IGV / VAT / GST (%)</div>
                            <input type="number" class="logistics-input" id="taxRate" placeholder="18" value="18" step="0.1" oninput="updateCalculations()">
                        </div>
                        <div class="logistics-box">
                            <div class="logistics-label">Agente Aduanal ($)</div>
                            <input type="number" class="logistics-input" id="brokerFee" placeholder="0.00" step="0.01" oninput="updateCalculations()">
                        </div>
                    </div>
                </div>

                <div class="form-grid" style="margin-top: 1.5rem;">
                    <div class="form-group">
                        <label>Incoterm</label>
                        <select id="incoterm" onchange="updatePreview()">
                            <option value="FOB">FOB (Free On Board)</option>
                            <option value="CIF">CIF (Cost, Insurance, Freight)</option>
                            <option value="CFR">CFR (Cost and Freight)</option>
                            <option value="EXW">EXW (Ex Works)</option>
                            <option value="DDP">DDP (Delivered Duty Paid)</option>
                            <option value="DAP">DAP (Delivered At Place)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Moneda / Currency</label>
                        <select id="currency" onchange="updateCalculations()">
                            <option value="USD">USD - US Dollar</option>
                            <option value="EUR">EUR - Euro</option>
                            <option value="PEN">PEN - Peruvian Sol</option>
                            <option value="CNY">CNY - Chinese Yuan</option>
                            <option value="MXN">MXN - Mexican Peso</option>
                            <option value="COP">COP - Colombian Peso</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Condiciones de Pago</label>
                        <select id="paymentTerms" onchange="updatePreview()">
                            <option value="TT">T/T (Wire Transfer)</option>
                            <option value="LC">L/C (Letter of Credit)</option>
                            <option value="DA">D/A (Documents against Acceptance)</option>
                            <option value="DP">D/P (Documents against Payment)</option>
                            <option value="CAD">CAD (Cash Against Documents)</option>
                            <option value="OA">O/A (Open Account)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tiempo de Entrega</label>
                        <input type="text" id="leadTime" placeholder="Ej: 30-45 d√≠as" oninput="updatePreview()">
                    </div>
                </div>
            </div>

            <!-- L√≠neas de Producto -->
            <div class="panel" style="margin-top: 2rem;">
                <h2 class="panel-title">
                    <span class="panel-icon">üìã</span>
                    L√≠neas de Producto
                </h2>
                
                <div class="product-header">
                    <div>SKU / Descripci√≥n</div>
                    <div>Qty</div>
                    <div>Unit ($)</div>
                    <div>Peso (kg)</div>
                    <div>Origen</div>
                    <div>Subtotal</div>
                    <div></div>
                </div>
                <div id="productsContainer"></div>
                
                <button class="btn btn-add" onclick="addProduct()">
                    + Agregar L√≠nea
                </button>
            </div>

            <div class="actions">
                <button class="btn btn-primary" onclick="calculateTotal()">
                    Calcular Proforma
                </button>
                <button class="btn btn-secondary" onclick="resetForm()">
                    Limpiar
                </button>
            </div>
        </div>

        <!-- Vista Previa -->
        <div class="preview-panel">
            <div class="document-frame">
                <div class="document-header">
                    <div class="doc-company">INDUSTRIAS TOBIAS</div>
                    <div class="doc-family">A Family Company</div>
                    <div class="doc-type">Proforma Invoice</div>
                </div>

                <div class="document-body" id="documentBody">
                    <!-- Trade Lane -->
                    <div class="trade-lane">
                        <div class="trade-box">
                            <div class="trade-label">Pa√≠s de Origen</div>
                            <div class="trade-country" id="previewOriginCountry">üá∫üá∏ USA</div>
                        </div>
                        <div class="trade-arrow">‚Üí</div>
                        <div class="trade-box">
                            <div class="trade-label">Pa√≠s de Destino</div>
                            <div class="trade-country" id="previewDestCountry">üáµüá™ PERU</div>
                        </div>
                    </div>

                    <div class="info-grid">
                        <div class="info-block">
                            <span class="info-label">Exportador / Shipper</span>
                            <span class="info-value" style="font-weight: 600;">INDUSTRIAS TOBIAS S.A.</span>
                            <span class="info-value" style="font-size: 0.85rem; color: var(--stone); margin-top: 0.25rem;">
                                350 Fifth Avenue, Suite 2500<br>
                                New York, NY 10118, USA<br>
                                export@industriastobias.com<br>
                                +1 (212) 555-0147
                            </span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">N¬∞ Proforma / Reference</span>
                            <span class="info-value" id="previewNumber">IT-2026-001</span>
                            <span class="info-label" style="margin-top: 0.75rem;">Fecha / Date</span>
                            <span class="info-value" id="previewDate">12 FEB 2026</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">Importador / Consignee</span>
                            <span class="info-value" id="previewClient">-</span>
                            <span class="info-value" id="previewTaxId" style="font-size: 0.85rem; color: var(--stone);">-</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">Ruta / Route</span>
                            <span class="info-value" id="previewRoute">JFK ‚Üí CALLAO</span>
                            <span class="info-label" style="margin-top: 0.75rem;">Incoterm</span>
                            <span class="info-value" id="previewIncoterm">FOB</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">Categor√≠a / Category</span>
                            <span class="info-value" id="previewCategory">-</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">Pago / Payment Terms</span>
                            <span class="info-value" id="previewPayment">T/T</span>
                        </div>
                    </div>

                    <table class="doc-table">
                        <thead>
                            <tr>
                                <th>Item / Description</th>
                                <th class="text-center">Qty</th>
                                <th class="text-right">Unit Price</th>
                                <th class="text-right">Weight</th>
                                <th class="text-right">Amount</th>
                            </tr>
                        </thead>
                        <tbody id="previewItems">
                            <tr>
                                <td colspan="5" style="text-align: center; color: var(--stone); padding: 3rem;">
                                    Ingrese productos para generar la proforma
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="costs-breakdown">
                        <div class="costs-title">Desglose de Costos Log√≠sticos / Logistics Breakdown</div>
                        <div class="costs-grid">
                            <div class="cost-item">
                                <span>Peso Total / Total Weight:</span>
                                <span id="previewTotalWeight">0.00 kg</span>
                            </div>
                            <div class="cost-item">
                                <span>Volumen / Volume:</span>
                                <span id="previewVolume">0.00 CBM</span>
                            </div>
                            <div class="cost-item">
                                <span>Tipo de Carga / Cargo Type:</span>
                                <span id="previewCargoType">FCL</span>
                            </div>
                            <div class="cost-item">
                                <span>Freight / Flete:</span>
                                <span id="previewShipping">$0.00</span>
                            </div>
                            <div class="cost-item">
                                <span>Insurance / Seguro (<span id="previewInsRate">2</span>%):</span>
                                <span id="previewInsurance">$0.00</span>
                            </div>
                            <div class="cost-item">
                                <span>Handling / THC:</span>
                                <span id="previewHandling">$0.00</span>
                            </div>
                            <div class="cost-item">
                                <span>Customs Duty / Derecho (<span id="previewDutyRate">0</span>%):</span>
                                <span id="previewDuty">$0.00</span>
                            </div>
                            <div class="cost-item">
                                <span>Broker / Agente:</span>
                                <span id="previewBroker">$0.00</span>
                            </div>
                            <div class="cost-item">
                                <span>Tax / IGV (<span id="previewTaxRate">18</span>%):</span>
                                <span id="previewTax">$0.00</span>
                            </div>
                        </div>
                    </div>

                    <div class="totals-section">
                        <div class="total-row">
                            <span>Valor FOB Total:</span>
                            <span id="previewFob">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Costo de Env√≠o (CIF/Freight):</span>
                            <span id="previewCif">$0.00</span>
                        </div>
                        <div class="total-row">
                            <span>Base Imponible / Taxable Base:</span>
                            <span id="previewBase">$0.00</span>
                        </div>
                        <div class="total-row bold">
                            <span>Total Impuestos & Derechos:</span>
                            <span id="previewTaxes">$0.00</span>
                        </div>
                        <div class="total-row final">
                            <span>TOTAL LANDED COST:</span>
                            <span id="previewTotal">$0.00</span>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem; font-size: 0.85rem; color: var(--stone);">
                        <strong>Tiempo de Entrega / Lead Time:</strong> <span id="previewLeadTime">Por confirmar</span>
                    </div>

                    <div class="document-footer">
                        <p style="font-style: italic; margin-bottom: 1rem;">
                            "All prices are subject to currency fluctuation. Validity: 30 calendar days.<br>
                            Los precios est√°n sujetos a fluctuaci√≥n de tipo de cambio. Validez: 30 d√≠as calendario."
                        </p>
                        <p>
                            <strong>Industrias Tobias S.A.</strong> | Registered in New York, USA<br>
                            350 Fifth Avenue, Suite 2500, New York, NY 10118<br>
                            export@industriastobias.com | +1 (212) 555-0147
                        </p>
                    </div>

                    <div class="document-stamp" id="docStamp">PENDIENTE</div>
                </div>
            </div>

            <div style="margin-top: 1.5rem; text-align: center;">
                <button class="btn btn-gold" onclick="downloadPDF()" style="width: 100%; justify-content: center;">
                    üìÑ Descargar Proforma PDF
                </button>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p style="margin-top: 1rem; color: var(--stone);">Generando documento...</p>
    </div>

    <script>
        let selectedCategory = null;
        let productCount = 0;
        let currencySymbol = '$';

        const countryFlags = {
            'US': 'üá∫üá∏', 'CN': 'üá®üá≥', 'PE': 'üáµüá™', 'CO': 'üá®üá¥', 'MX': 'üá≤üáΩ',
            'BR': 'üáßüá∑', 'AR': 'üá¶üá∑', 'CL': 'üá®üá±', 'EC': 'üá™üá®', 'BO': 'üáßüá¥',
            'PY': 'üáµüáæ', 'UY': 'üá∫üáæ', 'PA': 'üáµüá¶', 'CR': 'üá®üá∑', 'GT': 'üá¨üáπ',
            'IT': 'üáÆüáπ', 'ES': 'üá™üá∏', 'IN': 'üáÆüá≥', 'BD': 'üáßüá©', 'VN': 'üáªüá≥',
            'ID': 'üáÆüá©', 'TR': 'üáπüá∑'
        };

        const countryNames = {
            'US': 'USA', 'CN': 'CHINA', 'PE': 'PERU', 'CO': 'COLOMBIA', 'MX': 'MEXICO',
            'BR': 'BRAZIL', 'AR': 'ARGENTINA', 'CL': 'CHILE', 'EC': 'ECUADOR', 'BO': 'BOLIVIA',
            'PY': 'PARAGUAY', 'UY': 'URUGUAY', 'PA': 'PANAMA', 'CR': 'COSTA RICA', 'GT': 'GUATEMALA',
            'IT': 'ITALY', 'ES': 'SPAIN', 'IN': 'INDIA', 'BD': 'BANGLADESH', 'VN': 'VIETNAM',
            'ID': 'INDONESIA', 'TR': 'TURKEY'
        };

        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            const dateStr = today.toLocaleDateString('es-ES', { day: '2-digit', month: 'short', year: 'numeric' }).toUpperCase();
            document.getElementById('currentDate').textContent = dateStr;
            document.getElementById('previewDate').textContent = dateStr;
            
            const random = String(Math.floor(Math.random() * 900) + 100).padStart(3, '0');
            document.getElementById('previewNumber').textContent = `IT-2026-${random}`;
            
            addProduct();
            updatePreview();
        });

        function selectCategory(cat) {
            selectedCategory = cat;
            document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
            document.querySelector(`[data-cat="${cat}"]`).classList.add('active');
            
            const names = {
                'textile': 'Textil y Confecciones',
                'footwear': 'Calzado y Marroquiner√≠a',
                'accessories': 'Accesorios de Moda',
                'cosmetics': 'Cosm√©ticos y Maquillaje',
                'home': 'Art√≠culos para el Hogar',
                'industrial': 'Suministros Industriales',
                'raw': 'Materias Primas',
                'other': 'Otros Productos'
            };
            
            document.getElementById('previewCategory').textContent = names[cat] || cat;
        }

        function addProduct() {
            productCount++;
            const container = document.getElementById('productsContainer');
            
            const row = document.createElement('div');
            row.className = 'product-row';
            row.id = `prod-${productCount}`;
            
            row.innerHTML = `
                <input type="text" placeholder="SKU / Descripci√≥n completa" id="sku-${productCount}" oninput="updateCalculations()">
                <input type="number" placeholder="Qty" min="1" value="1" id="qty-${productCount}" oninput="updateCalculations()">
                <input type="number" placeholder="0.00" step="0.01" id="price-${productCount}" oninput="updateCalculations()">
                <input type="number" placeholder="0.00" step="0.01" id="weight-${productCount}" oninput="updateCalculations()">
                <input type="text" placeholder="Origen" id="origin-${productCount}" value="USA" oninput="updateCalculations()">
                <input type="text" placeholder="0.00" id="subtotal-${productCount}" readonly style="background: var(--warm-gray);">
                <button class="btn-remove" onclick="removeProduct(${productCount})">√ó</button>
            `;
            
            container.appendChild(row);
        }

        function removeProduct(id) {
            const row = document.getElementById(`prod-${id}`);
            if (document.querySelectorAll('.product-row').length > 1) {
                row.remove();
                updateCalculations();
            } else {
                document.getElementById(`sku-${id}`).value = '';
                document.getElementById(`qty-${id}`).value = 1;
                document.getElementById(`price-${id}`).value = '';
                document.getElementById(`weight-${id}`).value = '';
                updateCalculations();
            }
        }

        function updatePreview() {
            // Countries
            const originCode = document.getElementById('originCountry').value;
            const destCode = document.getElementById('destinationCountry').value;
            
            document.getElementById('previewOriginCountry').textContent = `${countryFlags[originCode]} ${countryNames[originCode]}`;
            document.getElementById('previewDestCountry').textContent = `${countryFlags[destCode]} ${countryNames[destCode]}`;
            
            // Ports
            const originPort = document.getElementById('originPort');
            const destPort = document.getElementById('destinationPort');
            document.getElementById('previewRoute').textContent = 
                `${originPort.options[originPort.selectedIndex].text.split(',')[0]} ‚Üí ${destPort.options[destPort.selectedIndex].text.split(',')[0]}`;
            
            // Client
            document.getElementById('previewClient').textContent = document.getElementById('clientName').value || '-';
            document.getElementById('previewTaxId').textContent = document.getElementById('taxId').value || '-';
            
            // Terms
            document.getElementById('previewIncoterm').textContent = document.getElementById('incoterm').value || 'FOB';
            
            const payments = {
                'TT': 'T/T (Wire Transfer)',
                'LC': 'L/C (Letter of Credit)',
                'DA': 'D/A (Docs vs Acceptance)',
                'DP': 'D/P (Docs vs Payment)',
                'CAD': 'CAD (Cash Against Docs)',
                'OA': 'O/A (Open Account)'
            };
            document.getElementById('previewPayment').textContent = 
                payments[document.getElementById('paymentTerms').value] || 'T/T';
            
            // Lead time
            document.getElementById('previewLeadTime').textContent = 
                document.getElementById('leadTime').value || 'Por confirmar / To be confirmed';
            
            // Cargo type
            const cargoTypes = { 'FCL': 'FCL (Full Container)', 'LCL': 'LCL (Consolidated)', 'AIR': 'Air Freight' };
            document.getElementById('previewCargoType').textContent = 
                cargoTypes[document.getElementById('cargoType').value] || 'FCL';
            
            // Currency
            const curr = document.getElementById('currency').value;
            currencySymbol = curr === 'USD' ? '$' : curr === 'EUR' ? '‚Ç¨' : curr === 'PEN' ? 'S/' : 
                            curr === 'CNY' ? '¬•' : curr === 'MXN' ? '$' : curr === 'COP' ? '$' : '$';
        }

        function updateCalculations() {
            let fobTotal = 0;
            let totalWeight = 0;
            const tbody = document.getElementById('previewItems');
            tbody.innerHTML = '';
            
            document.querySelectorAll('.product-row').forEach(row => {
                const id = row.id.split('-')[1];
                const sku = document.getElementById(`sku-${id}`).value || 'Item sin descripci√≥n';
                const qty = parseInt(document.getElementById(`qty-${id}`).value) || 0;
                const price = parseFloat(document.getElementById(`price-${id}`).value) || 0;
                const weight = parseFloat(document.getElementById(`weight-${id}`).value) || 0;
                const lineTotal = qty * price;
                const lineWeight = qty * weight;
                
                if (qty > 0 && price > 0) {
                    fobTotal += lineTotal;
                    totalWeight += lineWeight;
                    
                    document.getElementById(`subtotal-${id}`).value = lineTotal.toFixed(2);
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${sku}</td>
                        <td class="text-center">${qty}</td>
                        <td class="text-right">${currencySymbol}${price.toFixed(2)}</td>
                        <td class="text-right">${lineWeight.toFixed(2)} kg</td>
                        <td class="text-right">${currencySymbol}${lineTotal.toFixed(2)}</td>
                    `;
                    tbody.appendChild(tr);
                }
            });
            
            if (tbody.children.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; color: var(--stone); padding: 3rem;">
                            Ingrese productos para generar la proforma
                        </td>
                    </tr>
                `;
            }
            
            // Logistics
            const volume = parseFloat(document.getElementById('totalVolume').value) || 0;
            const shipping = parseFloat(document.getElementById('shippingCost').value) || 0;
            const insuranceRate = parseFloat(document.getElementById('insuranceRate').value) || 0;
            const handling = parseFloat(document.getElementById('handlingCost').value) || 0;
            const customsRate = parseFloat(document.getElementById('customsDuty').value) || 0;
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const broker = parseFloat(document.getElementById('brokerFee').value) || 0;
            
            const insurance = fobTotal * (insuranceRate / 100);
            const cifValue = fobTotal + shipping + insurance;
            const customsDuty = cifValue * (customsRate / 100);
            const taxableBase = cifValue + customsDuty;
            const tax = taxableBase * (taxRate / 100);
            const totalLanded = taxableBase + tax + handling + broker;
            
            // Update UI
            document.getElementById('previewTotalWeight').textContent = `${totalWeight.toFixed(2)} kg`;
            document.getElementById('previewVolume').textContent = `${volume.toFixed(2)} CBM`;
            document.getElementById('previewShipping').textContent = `${currencySymbol}${shipping.toFixed(2)}`;
            document.getElementById('previewInsRate').textContent = insuranceRate;
            document.getElementById('previewInsurance').textContent = `${currencySymbol}${insurance.toFixed(2)}`;
            document.getElementById('previewHandling').textContent = `${currencySymbol}${handling.toFixed(2)}`;
            document.getElementById('previewDutyRate').textContent = customsRate;
            document.getElementById('previewDuty').textContent = `${currencySymbol}${customsDuty.toFixed(2)}`;
            document.getElementById('previewBroker').textContent = `${currencySymbol}${broker.toFixed(2)}`;
            document.getElementById('previewTaxRate').textContent = taxRate;
            document.getElementById('previewTax').textContent = `${currencySymbol}${tax.toFixed(2)}`;
            
            document.getElementById('previewFob').textContent = `${currencySymbol}${fobTotal.toFixed(2)}`;
            document.getElementById('previewCif').textContent = `${currencySymbol}${(shipping + insurance).toFixed(2)}`;
            document.getElementById('previewBase').textContent = `${currencySymbol}${taxableBase.toFixed(2)}`;
            document.getElementById('previewTaxes').textContent = `${currencySymbol}${(customsDuty + tax).toFixed(2)}`;
            document.getElementById('previewTotal').textContent = `${currencySymbol}${totalLanded.toFixed(2)}`;
            
            // Stamp
            const stamp = document.getElementById('docStamp');
            if (fobTotal > 0) {
                stamp.textContent = 'VALIDADO';
                stamp.style.borderColor = 'var(--success)';
                stamp.style.color = 'var(--success)';
                stamp.style.opacity = '0.3';
            } else {
                stamp.textContent = 'PENDIENTE';
                stamp.style.borderColor = 'var(--tobias-gold)';
                stamp.style.color = 'var(--tobias-gold)';
                stamp.style.opacity = '0.25';
            }
        }

        function calculateTotal() {
            updateCalculations();
            const btn = document.querySelector('.btn-primary');
            const original = btn.innerHTML;
            btn.innerHTML = '‚úì Calculado';
            setTimeout(() => btn.innerHTML = original, 2000);
        }

        function downloadPDF() {
            document.getElementById('loading').classList.add('active');
            
            const element = document.getElementById('documentBody');
            const client = document.getElementById('clientName').value || 'Cliente';
            const opt = {
                margin: [0.5, 0.5, 0.5, 0.5],
                filename: `Proforma_IndustriasTobias_${client.replace(/\s+/g, '_')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, backgroundColor: '#ffffff' },
                jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            
            setTimeout(() => {
                html2pdf().set(opt).from(element).save().then(() => {
                    document.getElementById('loading').classList.remove('active');
                });
            }, 500);
        }

        function resetForm() {
            if (confirm('¬øLimpiar todos los datos de la proforma?')) {
                document.querySelectorAll('input').forEach(i => {
                    if (i.type !== 'button') i.value = '';
                });
                document.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
                document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
                selectedCategory = null;
                
                document.getElementById('productsContainer').innerHTML = '';
                productCount = 0;
                addProduct();
                
                // Defaults
                document.getElementById('insuranceRate').value = 2;
                document.getElementById('taxRate').value = 18;
                document.getElementById('originCountry').value = 'US';
                document.getElementById('destinationCountry').value = 'PE';
                
                updatePreview();
                updateCalculations();
            }
        }
    </script>
</body>
</html>
